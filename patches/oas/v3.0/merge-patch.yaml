---
$schema: https://spec.openapis.org/compliance/schemas/dialect/2023-06/oas-ontology
$id: https://spec.openapis.org/compliance/schemas/oas/3.0/2023-06
oasType: OpenAPI
oasChildren:
  0/info: 0#
  0/externalDocs: 0#
  0/servers/{index}: server
  0/security/{index}: 1#
  0/tags/{index}: tag
  0/paths: 0#
  0/components: 0#
oasLiterals:
  0/openapi: oasVersion
oasExtensible: true

$defs:
  RuntimeExpression:
    oasType: RuntimeExpression
    type: string
    pattern: \$(url$|method$|statusCode$|request\.|response\.)

  Callback:
    additionalProperties:
    oasType: Callback
    oasChildren:
      0/{name}/{pathTemplate}: callback
    oasExtensible: true

  Components:
    oasType: Components
    oasExtensible: true
    oasChildren:
        0/{type}: componentGroup
    properties:
      callbacks:
        oasType: CallbackComponents
        oasChildren:
            0/{name}: namedCallback
        patternProperties:
          ^[a-zA-Z0-9\.\-_]+$:
            oasReferences:
              0/$ref: Callback
      examples:
        oasType: ExampleComponents
        oasChildren:
            0/{name}: namedExample
        patternProperties:
          ^[a-zA-Z0-9\.\-_]+$:
            oasReferences:
              0/$ref: Example
      headers:
        oasType: HeaderComponents
        oasChildren:
            0/{name}: namedHeader
        patternProperties:
          ^[a-zA-Z0-9\.\-_]+$:
            oasReferences:
              0/$ref: Header
      links:
        oasType: LinkComponents
        oasChildren:
            0/{name}: namedLink
        patternProperties:
          ^[a-zA-Z0-9\.\-_]+$:
            oasReferences:
              0/$ref: Link
      parameters:
        oasType: ParameterComponents
        oasChildren:
            0/{name}: namedParameter
        patternProperties:
          ^[a-zA-Z0-9\.\-_]+$:
            oasReferences:
              0/$ref: Parameter
      requestBodies:
        oasType: RequestBodyComponents
        oasChildren:
            0/{name}: namedRequestBody
        patternProperties:
          ^[a-zA-Z0-9\.\-_]+$:
            oasReferences:
              0/$ref: RequestBody
      responses:
        oasType: ResponseComponents
        oasChildren:
            0/{name}: namedResponse
        patternProperties:
          ^[a-zA-Z0-9\.\-_]+$:
            oasReferences:
              0/$ref: Response
      schemas:
        oasType: SchemaComponents
        oasChildren:
            0/{name}: namedSchema
        patternProperties:
          ^[a-zA-Z0-9\.\-_]+$:
            oasReferences:
              0/$ref: Schema
      securitySchemes:
        oasType: SecuritySchemeComponents
        oasChildren:
            0/{name}: namedSecurityScheme
        patternProperties:
          ^[a-zA-Z0-9\.\-_]+$:
            oasReferences:
              0/$ref: SecurityScheme
    patternProperties:
      ^x-:
        oasType: ExtensionComponents
        oasChildren:
            0/{name}: namedExtensionComponents

  Contact:
    oasType: Contact
    oasLiterals:
      0/name: 0#
      0/url: 0#
      0/email: 0#
    oasExtensible: true

  Discriminator:
    oasType: Discriminator
    oasImplicitReferences:
      0/propertyName:
        oasTargetType: Schema
    properties:
      mapping:
        additionalProperties:
          oasValues:
            mappingName: '0#'
            mappingTarget: '0'

  Encoding:
    oasType: Encoding
    oasChildren:
      0/headers/{header}: header
    oasReferences:
      0/headers/{header}/$ref: Header
    oasLiterals:
      0/style: 0#
      0/explode: 0#
      0/allowReserved: 0#

  Example:
    oasType: Example
    oasLiterals:
      0/summary: 0#
      0/description: 0#
      0/value: 0#
    oasDescriptionLinks:
      0/externalValue: 0#
    oasExtensible: true
    properties:
      description:
        format: markdown-commonmark

  ExternalDocumentation:
    oasType: ExternalDocumentation
    oasLiterals:
      0/description: 0#
    oasDescriptionLinks:
      0/url: 0#
    oasExtensible: true
    properties:
      description:
        format: markdown-commonmark

  Header:
    oasType: Header
    oasChildren:
      0/schema: 0#
      0/{contentType}: content # TODO: Is this the same as "content" elsewhere?
    oasReferences:
      0/schema/$ref: Schema
      0/examples/{name}/$ref: Example
    oasLiterals:
      0/description: 0#
      0/required: 0#
      0/deprecated: 0#
      0/allowEmptyValue: 0#
      0/style: 0#
      0/explode: 0#
      0/allowReserved: 0#
    oasExamples:
      - 0/example
      - 0/examples/{name}/value
    properties:
      description:
        format: markdown-commonmark

  Info:
    oasType: Info
    oasChildren:
      0/contact: 0#
      0/license: 0#
    oasLiterals:
      0/title: 0#
      0/description: 0#
      0/version: apiDescriptionVersion
    oasDescriptionLinks:
      0/termsOfService: 0#
    oasExtensible: true
    properties:
      description:
        format: markdown-commonmark

  License:
    oasType: License
    oasLiterals:
      0/name: 0#
    oasDescriptionLinks:
      0/url: 0#
    oasExtensible: true

  Link:
    oasType: Link
    oasImplicitReferences:
      0/operationId:
        oasRelationType: operationIdRef
        oasTargetType: Operation
        oasTargetField: 0/operationId
      0/parameters/{name}#:
        # TODO: How much of this is really worth describing?
        #       oasTargetQualifier is essentially a one-off for
        #       this field, plus there is the constraint that
        #       the parameter referenced is connected to the
        #       Operation referenced by operationId or operationRef
        #       which is not being captured here.
        oasTargetType: Parameter
        oasTargetField: 0/name
        oasTargetQualifier: 0/in
    oasReferences:
        0/operationRef: Operation
    properties:
      parameters:
        propertyNames:
          oasType: QualifiedTemplateParameter
        additionalProperties:
          type: string
    oneOf:
      - oasChildren:
          0/parameters/{parameterSpecification}: parameterExpression
        properties:
          parameters:
            additionalProperties:
              $ref: '#/$defs/RuntimeExpression'
      - oasLiterals:
          0/parameters/{parameterSpecification}: parameterValue
        properties:
          parameters:
            additionalProperties:
              not: {$ref: '#/$defs/RuntimeExpression'}

  MediaType:
    oasType: MediaType
    oasChildren:
      0/schema: 0#
      0/encoding/{property}: 1#
    oasReferences:
      0/schema/$ref: Schema
      0/examples/{name}/$ref: Example
    oasExamples:
      - 0/example
      - 0/examples/{name}

  OAuthFlows:
    oasLiterals:
      0/scopes/{scopeName}: scope
    oasApiLinks:
      0/authorizationUrl: 0#
      0/tokenUrl: 0#
      0/refreshUrl: 0#
    oasExtensible: true
    patternProperties:
      ^x-:
        oasType: ExtensionOAuthFlow
  ImplicitOAuthFlow:
    oasType: ImplicitOAuthFlow
  PasswordOAuthFlow:
    oasType: PasswordOAuthFlow
  ClientCredentialsFlow:
    oasType: ClientCredentialsFlow
  AuthorizationCodeOAuthFlow:
    oasType: AuthorizationCodeOAuthFlow

  Operation:
    # for oasType, see /$defs/PathItem/properties/(get|put|...)
    oasChildren:
      0/externalDocs: 0#
      0/parameters/{index}: parameter
      0/requestBody: 0#
      0/responses: 0#
      0/callbacks: 0#
      0/security/{index}: security
      0/servers/{index}: server
    oasImplicitReferences:
      0/tags/{index}:
        oasRelationType: tagRef
        oasTargetType: Tag
        oasTargetField: 0/name
        oasTargetRequired: False
    oasReferences:
      0/externalDocs/$ref: ExternalDocumentation
      0/parameters/{index}/$ref: Parameter
      0/requestBody/$ref: RequestBody
      0/callbacks/{name}/$ref: Callback
    oasLiterals:
      0/summary: 0#
      0/description: 0#
      0/operationId: 0#
      0/deprecated: 0#
    properties:
      description:
        format: markdown-commonmark
      tags:
        items:
          oasType: TagName

  Parameter:
    oasChildren:
      0/schema: 0#
      0/content/{contentType}: 1#
    oasReferences:
      0/schema/$ref: Schema
      0/examples/{name}/$ref: Example
    oasLiterals:
      0/name: 0#
      0/in: parameterLocation
      0/description: 0#
      0/required: 0#
      0/deprecated: 0#
      0/allowEmptyValue: 0#
      0/style: 0#
      0/explode: 0#
      0/allowReserved: 0#
    oasUniqueKey:
      - 0/name
      - 0/in
    oasExamples:
      - 0/example
      - 0/examples/{name}
    oasExtensible: true
    properties:
      description:
        format: markdown-commonmark
  PathParameter:
    oasType: PathParameter
    properties:
      name:
        oasType: TemplateParameter
  QueryParameter:
    oasType: QueryParameter
  HeaderParameter:
    oasType: HeaderParameter
  CookieParameter:
    oasType: CookieParameter

  PathItem:
    oasType: PathItem
    oasChildren:
      0/delete: operation
      0/get: operation
      0/head: operation
      0/options: operation
      0/patch: operation
      0/post: operation
      0/put: operation
      0/trace: operation
    oasReferences:
      0/$ref: PathItem
      0/parameters/$ref: Parameter
    oasReferenceConflict:
      0/$ref: undefined
    oasLiterals:
      0/summary: 0#
      0/description: 0#
    properties:
      description:
        format: markdown-commonmark
      delete:
        oasType: DeleteOperation
      get:
        oasType: GetOperation
      head:
        oasType: HeadOperation
      options:
        oasType: OptionsOperation
      patch:
        oasType: PatchOperation
      post:
        oasType: PostOperation
      put:
        oasType: PutOperation
      trace:
        oasType: TraceOperation

  Paths:
    oasType: Paths
    oasChildren:
      0/{pathTemplate}: pathItem
    oasExtensible: true
    propertyNames:
        anyOf:
          - pattern: '^\/'
            oasType: PathOnlyTemplatedUrl
          - true

  Reference:
    # oasReferences is set adjacent to where this schema is referenced,
    # as that is where the intended reference target type is clear.
    oasType: Reference

  RequestBody:
    oasType: RequestBody
    oasChildren:
      0/content/{contentType}: content
    oasLiterals:
      0/description: 0#
      0/required: 0#
    oasExtensible: True
    properties:
      description:
        format: markdown-commonmark

  Response:
    oasType: Response
    oasReferences:
      0/headers/{header}/$ref: Header
      0/links/{linkRel}/$ref: Link
    oasChildren:
      0/headers/{header}: header
      0/content/{contentType}: 1#
      0/links/{linkRel}: link
    oasLiterals:
      0/description: 0#
    oasExtensible: true
    properties:
      description:
        format: markdown-commonmark

  Responses:
    oasType: Responses
    oasReferences:
      # TODO: "^x-" statuses may not support $ref
      0/{statusSpecification}/$ref: Response
    oasChildren:
      0/{statusSpecification}: response
    oasExtensible: true
    propertyNames:
      anyOf:
        - const: default
          oasType: StatusDefault
        - pattern: '^[1-5]\d{2}$'
          oasType: StatusCode
        - pattern: '^[1-5]XX$'
          oasType: StatusCodeRange
        - true

  Schema:
    oasType: Schema
    oasReferences:
      # TODO: Would `0/$ref: Schema` work here?
      #       I do not think there is anywhere that a Schema Object
      #       cannot be replaced by a Reference Object.  Also should
      #       check if similar conditions hold for other oasTypes.
      0/allOf/{index}/$ref: Schema
      0/anyOf/{index}/$ref: Schema
      0/oneOf/{index}/$ref: Schema
      0/not/$ref: Schema
      0/properties/{name}/$ref: Schema
      0/additionalProperties/$ref: Schema
      0/items/$ref: Schema
    oasChildren:
      0/allOf/{index}: schemaAllOf
      0/anyOf/{index}: schemaAnyOf
      0/oneOf/{index}: schemaOneOf
      0/not: schemaNot
      0/properties/{name}: schemaProperty
      0/additionalProperties: schemaAdditionalProperties
      0/items: schemaItems
      0/xml: schemaXml
      0/discriminator: schemaDiscriminator
      0/externalDocs: externalDocs
    oasLiterals:
      0/type: schemaType
      0/enum: schemaEnum
      0/maximum: schemaMaximum
      0/minimum: schemaMinimum
      0/exclusiveMaximum: schemaExclusiveMaximum
      0/exclusiveMinimum: schemaExclusiveMinimum
      0/multipleOf: schemaMultipleOf
      0/maxLength: schemaMaxLength
      0/minLength: schemaMinLength
      0/pattern: schemaPattern
      0/maxItems: schemaMaxItems
      0/minItems: schemaMinItems
      0/uniqueItems: schemaUniqueItems
      0/maxProperties: schemaMaxProperties
      0/minProperties: schemaMinProperties
      0/required: schemaRequired
      0/title: schemaTitle
      0/description: schemaDescription
      0/format: schemaFormat
      0/default: schemaDefault
      0/readOnly: schemaReadOnly
      0/writeOnly: schemaWriteOnly
      0/deprecated: schemaDeprecated
      0/nullable: schemaNullable
    oasExamples:
      - 0/example
    oasExtensible: True
    properties:
      description:
        format: markdown-commonmark

  SecurityRequirement:
    oasType: SecurityRequirement
    additionalProperties:
    oasImplicitReferences:
      0/{scheme}#:
        oasRelationType: securitySchemeRef
        oasTargetType: SecurityScheme
        oasTargetField: 0/scheme
      0/{scheme}/{index}:
        oasRelationType: securitySchemeScopeRef
        oasTargetType: SecurityScheme
        oasTargetField: 0/{scheme}/flows/{flow}/scopes/{scope}#
  Server:
    oasType: Server
    oasChildren:
      0/variables/{name}: variable
    oasLiterals:
      0/description: 0#
    oasApiLinks:
      0/url: 0#
    oasExtensible: true
    properties:
      description:
        format: markdown-commonmark

  ServerVariable:
    oasType: ServerVariable
    oasImplicitReferences:
      '0#':
        oasRelationType: serverVariableRef
        oasTargetType: Server
        oasTargetField: 0/url
        oasTargetIsTemplateVariable: true
    oasLiterals:
      0/enum/{index}: 1#
      0/default: 0#
      0/description: 0#
    oasExtensible: true
    properties:
      description:
        format: markdown-commonmark

  XML:
    oasType: Xml
    oasLiterals:
      0/name: 0#
      0/namespace: xmlNamespace
      0/prefix: xmlPrefix
      0/attribute: xmlAttribute
      0/wrapped: 0#
    oasExtensible: true

  Tag:
    oasType: Tag
    oasChildren:
      0/externalDocs: 0#
    oasLiterals:
      0/name: 0#
      0/description: 0#
    properties:
      description:
        format: markdown-commonmark

  SecurityScheme:
    oasLiterals:
      0/type: 0#
      0/name: 0#
      0/in: parameteLocation
      0/description: 0#
    oasExtensible: true
    properties:
      description:
        format: markdown-commonmark
  APIKeySecurityScheme:
    oasType: APIKeySecurityScheme
  HTTPSecurityScheme:
    oasType: HTTPSecurityScheme
  OAuth2SecurityScheme:
    oasType: OAuth2SecurityScheme
  OpenIdConnectSecurityScheme:
    oasType: OpenIdConnectSecurityScheme

